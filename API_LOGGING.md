# üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ API –∑–∞–ø—Ä–æ—Å–æ–≤

## –û–±–∑–æ—Ä

–í –ø—Ä–æ–µ–∫—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ REST API. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∑–∞–ø—Ä–æ—Å–æ–≤.

## üîç –ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è

### 1. **–í—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã**

–ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∫ API –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ Serial:

```
[API] GET /api/status
[API] GET /api/servo
[API] POST /api/servo
[API] POST /api/servo/calibrate
[API] GET /api/motor
[API] POST /api/motor
[API] POST /api/motor/stop
[API] GET / (HTML page)
[API] OPTIONS (CORS preflight)
```

### 2. **–¢–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–æ–≤**

–î–ª—è POST –∑–∞–ø—Ä–æ—Å–æ–≤ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:

```
[API] Request body: {"id":0,"angle":90}
[API] Servo ID: 0, Angle: 90
[API] Servo 0 set to 90¬∞
```

### 3. **–û—Ç–≤–µ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞**

–ö–∞–∂–¥—ã–π –æ—Ç–≤–µ—Ç –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å –∫–æ–¥–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è:

```
[API] Response [200]: {"success":true,"servo":0,"angle":90}
[API] Response [400]: {"error":"Invalid angle (must be 0-180)"}
[API] Response [404]: {"error":"Endpoint not found"}
```

### 4. **–û—à–∏–±–∫–∏**

–í—Å–µ –æ—à–∏–±–∫–∏ –¥–µ—Ç–∞–ª—å–Ω–æ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:

```
[API] ERROR: No data provided
[API] ERROR: Invalid JSON - InvalidInput
[API] ERROR: Invalid servo ID: 25
[API] ERROR: Invalid angle: 200
[API] ERROR: Invalid pulse values
```

### 5. **–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã**

```
[API] Not Found: POST /api/unknown
[API] Not Found: GET /favicon.ico
```

## üñ•Ô∏è –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

### PlatformIO

```bash
# –û—Ç–∫—Ä—ã—Ç—å Serial Monitor
pio device monitor

# –ò–ª–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Å–∫–æ—Ä–æ—Å—Ç–∏
pio device monitor --baud 115200
```

### Arduino IDE

- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã ‚Üí –ú–æ–Ω–∏—Ç–æ—Ä –ø–æ—Ä—Ç–∞
- –°–∫–æ—Ä–æ—Å—Ç—å: 115200 –±–æ–¥

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
========================================
   ESP32-S3 Robot Controller v2.0
========================================

=== LittleFS Initialization ===
LittleFS initialized successfully
index.html found
===============================

=== WiFi Initialization ===
Creating Access Point: RobotAP
Access Point created successfully!
AP IP address: 192.168.4.1
AP MAC address: XX:XX:XX:XX:XX:XX
===========================


=== API Initialization ===
HTTP server started on port 8080
================================

‚úì All systems initialized
========================================

[API] GET / (HTML page)
[API] Sending HTML page (15234 bytes)
[API] GET /api/status
[API] Response [200]: {"status":"ok","ip":"192.168.4.1","servos_count":4}
[API] POST /api/servo
[API] Request body: {"id":0,"angle":90}
[API] Servo ID: 0, Angle: 90
[API] Servo 0 set to 90¬∞
[API] Response [200]: {"success":true,"servo":0,"angle":90}
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ

–í —Ñ–∞–π–ª–µ `src/api.cpp`:

```cpp
// –§–ª–∞–≥ –≤–∫–ª—é—á–µ–Ω–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
#define API_LOG_ENABLED true  // ‚Üê –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ false –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
```

### –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤

–§—É–Ω–∫—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

```cpp
void api_log(const String& message) {
  if (API_LOG_ENABLED) {
    Serial.println("[API] " + message);
  }
}
```

## üêõ –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "–í—Å–µ –∑–∞–≤–∏—Å–∞–µ—Ç –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞–ø—Ä–æ—Å–∞"

**–†–µ—à–µ–Ω–∏–µ:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ Serial Monitor
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ API
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   - –ó–∞–ø—Ä–æ—Å –¥–æ—Å—Ç–∏–≥ —Å–µ—Ä–≤–µ—Ä–∞?
   - –ï—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON?
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ª–∏ –æ—Ç–≤–µ—Ç?

**–ü—Ä–∏–º–µ—Ä –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:**

```
# –ù–µ—Ç –ª–æ–≥–æ–≤ –≤–æ–æ–±—â–µ
‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WiFi
‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ IP –∞–¥—Ä–µ—Å –∏ –ø–æ—Ä—Ç

# –ó–∞–ø—Ä–æ—Å –ø–æ–ª—É—á–µ–Ω, –Ω–æ –Ω–µ—Ç –æ—Ç–≤–µ—Ç–∞
‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–µ
‚Üí –í–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ JSON

# –û—à–∏–±–∫–∞ "Invalid JSON"
‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚Üí –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Content-Type: application/json
```

### –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

#### 1. **404 Not Found**

```
[API] Not Found: GET /api/unknow
```

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å URL

#### 2. **400 Bad Request - No data provided**

```
[API] POST /api/servo
[API] ERROR: No data provided
```

**–†–µ—à–µ–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ JSON –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞:
```json
{"id":0,"angle":90}
```

#### 3. **400 Bad Request - Invalid JSON**

```
[API] POST /api/servo
[API] ERROR: Invalid JSON - InvalidInput
```

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç JSON:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–≤–æ–π–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏ `"`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–ø—è—Ç—ã–µ –º–µ–∂–¥—É –ø–æ–ª—è–º–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ª–∏—à–Ω–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤

#### 4. **CORS –æ—à–∏–±–∫–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ**

```
Access to fetch at ... has been blocked by CORS policy
```

**–†–µ—à–µ–Ω–∏–µ:** –ë—Ä–∞—É–∑–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç OPTIONS –∑–∞–ø—Ä–æ—Å:
```
[API] OPTIONS (CORS preflight)
```

–°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏:
```
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: GET, POST, OPTIONS
Access-Control-Allow-Headers: Content-Type
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–õ–æ–≥–∏ –ø–æ–º–æ–≥–∞—é—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API:

- –ö–∞–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —á–∞—â–µ
- –ö–∞–∫–∏–µ –æ—à–∏–±–∫–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

---

**–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:** –§–µ–≤—Ä–∞–ª—å 2026  
**–í–µ—Ä—Å–∏—è:** 1.0
