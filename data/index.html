<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>Robot Control Panel</title>
  
  <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ CSS -->
  <link rel="stylesheet" href="style.css" onload="document.getElementById('css-loader').style.display='none'">
  <style>
    /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ CSS */
    #css-loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(90deg, #00d9ff, #00ff88, #00d9ff);
      background-size: 200% 100%;
      animation: loading 1.5s infinite linear;
      z-index: 9999;
    }
    @keyframes loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
    /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ JS */
    #js-loader {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(0, 217, 255, 0.9);
      color: #1a1a2e;
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: bold;
      font-size: 14px;
      z-index: 9999;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    /* –°–∫—Ä—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –ø–æ–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è JS */
    body.loading .container {
      opacity: 0.5;
      pointer-events: none;
    }
    /* –°—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–∫–∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ */
    .btn-emergency-stop {
      background: linear-gradient(135deg, #ff4444, #cc0000);
      color: white;
      border: none;
      padding: 20px 40px;
      border-radius: 12px;
      font-size: 20px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(255, 68, 68, 0.5);
      text-transform: uppercase;
      letter-spacing: 2px;
    }
    .btn-emergency-stop:hover {
      background: linear-gradient(135deg, #ff0000, #aa0000);
      box-shadow: 0 6px 25px rgba(255, 0, 0, 0.7);
      transform: scale(1.05);
    }
    .btn-emergency-stop:active {
      transform: scale(0.95);
    }
    .emergency-section {
      background: rgba(255, 68, 68, 0.1);
      border: 2px solid rgba(255, 68, 68, 0.5);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 30px;
      text-align: center;
    }
    .emergency-section h2 {
      color: #ff4444;
      margin-bottom: 15px;
      text-shadow: 0 0 10px rgba(255, 68, 68, 0.5);
    }
    .info-box {
      background: rgba(0, 217, 255, 0.1);
      border-left: 4px solid #00d9ff;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 5px;
    }
    .info-box h4 {
      color: #00d9ff;
      margin-bottom: 10px;
    }
    .info-box ul {
      color: #aaa;
      font-size: 13px;
      line-height: 1.6;
      padding-left: 20px;
    }
  </style>
</head>

<body class="loading">
  <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ CSS -->
  <div id="css-loader"></div>
  
  <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ JS -->
  <div id="js-loader">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ JavaScript...</div>

  <div class="container">
    <h1>ü§ñ Robot Control Panel</h1>

    <!-- –ö–Ω–æ–ø–∫–∞ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ -->
    <div class="emergency-section">
      <h2>üö® –≠–ö–°–¢–†–ï–ù–ù–ê–Ø –û–°–¢–ê–ù–û–í–ö–ê</h2>
      <button class="btn-emergency-stop" onclick="emergencyStopAll()">üõë –°–¢–û–ü –í–°–Å</button>
    </div>

    <div class="status-bar">
      <div class="status-item">
        <div class="status-led"></div>
        <span>System Online</span>
      </div>
      <div class="status-item">
        <span>IP: <strong id="robot-ip">Loading...</strong></span>
      </div>
      <div class="status-item">
        <a href="/api/ota" class="btn-ota" target="_blank">üîÑ OTA Update</a>
      </div>
    </div>

    <!-- –ó–∞–∫–ª–∞–¥–∫–∏ -->
    <div class="tabs-container">
      <div class="tabs">
        <button class="tab-button active" onclick="switchTab('parameters')">üéõÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã</button>
        <button class="tab-button" onclick="switchTab('joystick')">üïπÔ∏è –î–∂–æ–π—Å—Ç–∏–∫</button>
        <button class="tab-button" onclick="switchTab('camera')">üì∑ –ö–∞–º–µ—Ä–∞</button>
      </div>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ 1: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã -->
    <div id="tab-parameters" class="tab-content active">

      <!-- –°–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥—ã -->
      <div class="panel">
        <h2>üîß –°–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥—ã</h2>
        <div class="servo-grid">
          <div class="servo-card">
            <h3>Servo 0</h3>
            <div class="servo-control">
              <label>–£–≥–æ–ª: <span id="servo0-value">90</span>¬∞</label>
              <input type="range" id="servo0" min="0" max="180" value="90" oninput="updateServoValue(0, this.value)">
            </div>
            <button class="btn-apply" onclick="setServo(0)">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            <div class="calibrate-section">
              <h4>–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞</h4>
              <div class="calibrate-inputs">
                <input type="number" id="servo0-min" placeholder="Min" value="140">
                <input type="number" id="servo0-max" placeholder="Max" value="480">
              </div>
              <button class="btn-calibrate" onclick="calibrateServo(0)">–ö–∞–ª–∏–±—Ä–æ–≤–∞—Ç—å</button>
            </div>
          </div>

          <div class="servo-card">
            <h3>Servo 1</h3>
            <div class="servo-control">
              <label>–£–≥–æ–ª: <span id="servo1-value">90</span>¬∞</label>
              <input type="range" id="servo1" min="0" max="180" value="90" oninput="updateServoValue(1, this.value)">
            </div>
            <button class="btn-apply" onclick="setServo(1)">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            <div class="calibrate-section">
              <h4>–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞</h4>
              <div class="calibrate-inputs">
                <input type="number" id="servo1-min" placeholder="Min" value="140">
                <input type="number" id="servo1-max" placeholder="Max" value="480">
              </div>
              <button class="btn-calibrate" onclick="calibrateServo(1)">–ö–∞–ª–∏–±—Ä–æ–≤–∞—Ç—å</button>
            </div>
          </div>

          <div class="servo-card">
            <h3>Servo 2</h3>
            <div class="servo-control">
              <label>–£–≥–æ–ª: <span id="servo2-value">90</span>¬∞</label>
              <input type="range" id="servo2" min="0" max="180" value="90" oninput="updateServoValue(2, this.value)">
            </div>
            <button class="btn-apply" onclick="setServo(2)">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            <div class="calibrate-section">
              <h4>–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞</h4>
              <div class="calibrate-inputs">
                <input type="number" id="servo2-min" placeholder="Min" value="140">
                <input type="number" id="servo2-max" placeholder="Max" value="480">
              </div>
              <button class="btn-calibrate" onclick="calibrateServo(2)">–ö–∞–ª–∏–±—Ä–æ–≤–∞—Ç—å</button>
            </div>
          </div>

          <div class="servo-card">
            <h3>Servo 3</h3>
            <div class="servo-control">
              <label>–£–≥–æ–ª: <span id="servo3-value">90</span>¬∞</label>
              <input type="range" id="servo3" min="0" max="180" value="90" oninput="updateServoValue(3, this.value)">
            </div>
            <button class="btn-apply" onclick="setServo(3)">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            <div class="calibrate-section">
              <h4>–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞</h4>
              <div class="calibrate-inputs">
                <input type="number" id="servo3-min" placeholder="Min" value="140">
                <input type="number" id="servo3-max" placeholder="Max" value="480">
              </div>
              <button class="btn-calibrate" onclick="calibrateServo(3)">–ö–∞–ª–∏–±—Ä–æ–≤–∞—Ç—å</button>
            </div>
          </div>
        </div>
      </div>


      <!-- DC –ú–æ—Ç–æ—Ä—ã -->
      <div class="panel">
        <h2>üöó DC –ú–æ—Ç–æ—Ä—ã</h2>
        <div class="motor-grid">
          <div class="motor-card">
            <h3>Motor A</h3>
            <div class="motor-controls">
              <button class="motor-btn btn-reverse" onmousedown="startMotor('A', -255)" onmouseup="stopMotor('A')"
                ontouchstart="startMotor('A', -255)" ontouchend="stopMotor('A')">‚óÄ</button>
              <button class="motor-btn btn-stop" onclick="setMotorSpeed('A', 0)">‚ñ†</button>
              <button class="motor-btn btn-forward" onmousedown="startMotor('A', 255)" onmouseup="stopMotor('A')"
                ontouchstart="startMotor('A', 255)" ontouchend="stopMotor('A')">‚ñ∂</button>
            </div>
            <div class="motor-speed">–°–∫–æ—Ä–æ—Å—Ç—å: <span id="motorA-speed">0</span></div>
            <div class="motor-slider">
              <label>–¢–æ—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏:</label>
              <div class="slider-value"><span id="motorA-value">0</span></div>
              <input type="range" class="motor-range" id="motorA-range" min="-255" max="255" value="0"
                oninput="updateMotorValue('A', this.value)">
              <div class="motor-slider-input">
                <input type="number" id="motorA-input" min="-255" max="255" value="0" placeholder="-255...255">
                <button class="btn-apply-motor" onclick="setMotorFromSlider('A')">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
              </div>
            </div>
          </div>

          <div class="motor-card">
            <h3>Motor B</h3>
            <div class="motor-controls">
              <button class="motor-btn btn-reverse" onmousedown="startMotor('B', -255)" onmouseup="stopMotor('B')"
                ontouchstart="startMotor('B', -255)" ontouchend="stopMotor('B')">‚óÄ</button>
              <button class="motor-btn btn-stop" onclick="setMotorSpeed('B', 0)">‚ñ†</button>
              <button class="motor-btn btn-forward" onmousedown="startMotor('B', 255)" onmouseup="stopMotor('B')"
                ontouchstart="startMotor('B', 255)" ontouchend="stopMotor('B')">‚ñ∂</button>
            </div>
            <div class="motor-speed">–°–∫–æ—Ä–æ—Å—Ç—å: <span id="motorB-speed">0</span></div>
            <div class="motor-slider">
              <label>–¢–æ—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏:</label>
              <div class="slider-value"><span id="motorB-value">0</span></div>
              <input type="range" class="motor-range" id="motorB-range" min="-255" max="255" value="0"
                oninput="updateMotorValue('B', this.value)">
              <div class="motor-slider-input">
                <input type="number" id="motorB-input" min="-255" max="255" value="0" placeholder="-255...255">
                <button class="btn-apply-motor" onclick="setMotorFromSlider('B')">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
              </div>
            </div>
          </div>

          <div class="motor-card">
            <h3>Motor C</h3>
            <div class="motor-controls">
              <button class="motor-btn btn-reverse" onmousedown="startMotor('C', -255)" onmouseup="stopMotor('C')"
                ontouchstart="startMotor('C', -255)" ontouchend="stopMotor('C')">‚óÄ</button>
              <button class="motor-btn btn-stop" onclick="setMotorSpeed('C', 0)">‚ñ†</button>
              <button class="motor-btn btn-forward" onmousedown="startMotor('C', 255)" onmouseup="stopMotor('C')"
                ontouchstart="startMotor('C', 255)" ontouchend="stopMotor('C')">‚ñ∂</button>
            </div>
            <div class="motor-speed">–°–∫–æ—Ä–æ—Å—Ç—å: <span id="motorC-speed">0</span></div>
            <div class="motor-slider">
              <label>–¢–æ—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏:</label>
              <div class="slider-value"><span id="motorC-value">0</span></div>
              <input type="range" class="motor-range" id="motorC-range" min="-255" max="255" value="0"
                oninput="updateMotorValue('C', this.value)">
              <div class="motor-slider-input">
                <input type="number" id="motorC-input" min="-255" max="255" value="0" placeholder="-255...255">
                <button class="btn-apply-motor" onclick="setMotorFromSlider('C')">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
              </div>
            </div>
          </div>

          <div class="motor-card">
            <h3>Motor D</h3>
            <div class="motor-controls">
              <button class="motor-btn btn-reverse" onmousedown="startMotor('D', -255)" onmouseup="stopMotor('D')"
                ontouchstart="startMotor('D', -255)" ontouchend="stopMotor('D')">‚óÄ</button>
              <button class="motor-btn btn-stop" onclick="setMotorSpeed('D', 0)">‚ñ†</button>
              <button class="motor-btn btn-forward" onmousedown="startMotor('D', 255)" onmouseup="stopMotor('D')"
                ontouchstart="startMotor('D', 255)" ontouchend="stopMotor('D')">‚ñ∂</button>
            </div>
            <div class="motor-speed">–°–∫–æ—Ä–æ—Å—Ç—å: <span id="motorD-speed">0</span></div>
            <div class="motor-slider">
              <label>–¢–æ—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏:</label>
              <div class="slider-value"><span id="motorD-value">0</span></div>
              <input type="range" class="motor-range" id="motorD-range" min="-255" max="255" value="0"
                oninput="updateMotorValue('D', this.value)">
              <div class="motor-slider-input">
                <input type="number" id="motorD-input" min="-255" max="255" value="0" placeholder="-255...255">
                <button class="btn-apply-motor" onclick="setMotorFromSlider('D')">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
              </div>
            </div>
          </div>
        </div>

        <div class="motor-actions">
          <button class="btn-stop-all" onclick="stopAllMotors()">üõë –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –º–æ—Ç–æ—Ä—ã</button>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ–º–∏ –º–æ—Ç–æ—Ä–∞–º–∏ -->
        <div class="panel" style="margin-top: 20px;">
          <h2>üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º–∏ –º–æ—Ç–æ—Ä–∞–º–∏</h2>
          <div
            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
            <div>
              <label style="color: #aaa; font-size: 14px;">Motor A:</label>
              <input type="number" id="all-motorA" min="-255" max="255" value="0"
                style="width: 100%; padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 5px; background: rgba(255,255,255,0.1); color: white; font-size: 16px;">
            </div>
            <div>
              <label style="color: #aaa; font-size: 14px;">Motor B:</label>
              <input type="number" id="all-motorB" min="-255" max="255" value="0"
                style="width: 100%; padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 5px; background: rgba(255,255,255,0.1); color: white; font-size: 16px;">
            </div>
            <div>
              <label style="color: #aaa; font-size: 14px;">Motor C:</label>
              <input type="number" id="all-motorC" min="-255" max="255" value="0"
                style="width: 100%; padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 5px; background: rgba(255,255,255,0.1); color: white; font-size: 16px;">
            </div>
            <div>
              <label style="color: #aaa; font-size: 14px;">Motor D:</label>
              <input type="number" id="all-motorD" min="-255" max="255" value="0"
                style="width: 100%; padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 5px; background: rgba(255,255,255,0.1); color: white; font-size: 16px;">
            </div>
          </div>
          <button class="btn-apply" onclick="setAllMotors()" style="width: 100%;">üöÄ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –≤—Å–µ—Ö
            –º–æ—Ç–æ—Ä–æ–≤</button>
        </div>
      </div>
    </div>
    <!-- –í–∫–ª–∞–¥–∫–∞ 2: –î–∂–æ–π—Å—Ç–∏–∫ -->
    <div id="tab-joystick" class="tab-content">
      <div class="joystick-container">
        <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å: –î–∂–æ–π—Å—Ç–∏–∫ -->
        <div class="joystick-panel">
          <h2>üïπÔ∏è –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –¥–∂–æ–π—Å—Ç–∏–∫</h2>

          <div class="joystick-control" id="joystick">
            <div class="joystick-knob" id="joystick-knob"></div>
          </div>

          <div class="joystick-values">
            <div class="value-display">X: <span id="joy-x">0</span></div>
            <div class="value-display">Y: <span id="joy-y">0</span></div>
          </div>

          <div class="mode-selector">
            <button class="mode-btn active" onclick="setJoystickMode('drive')" data-mode="drive">üöó –ï–∑–¥–∞</button>
            <button class="mode-btn" onclick="setJoystickMode('servo')" data-mode="servo">üîß –°–µ—Ä–≤–æ</button>
            <button class="mode-btn" onclick="setJoystickMode('mixed')" data-mode="mixed">üéØ –ú–∏–∫—Å</button>
          </div>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å: –°—Ç–∞—Ç—É—Å –º–æ—Ç–æ—Ä–æ–≤ + –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è -->
        <div class="joystick-panel">
          <h2>üìä –°—Ç–∞—Ç—É—Å –º–æ—Ç–æ—Ä–æ–≤</h2>

          <!-- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ–≤–µ—Ä–∞ -->
          <div class="rover-visualizer">
            <svg viewBox="0 0 260 380" class="rover-svg">
              <!-- –ö–æ—Ä–ø—É—Å —Ä–æ–≤–µ—Ä–∞ -->
              <rect x="105" y="160" width="50" height="80" rx="8" fill="rgba(0, 217, 255, 0.15)" stroke="#00d9ff"
                stroke-width="2" />

              <!-- –ú–µ—Ç–∫–∞ –ø–µ—Ä–µ–¥–∞ -->
              <polygon points="130,145 125,155 135,155" fill="#00ff88" />
              <text x="130" y="140" text-anchor="middle" fill="#00ff88" font-size="14" font-weight="bold">‚ñ≤</text>

              <!-- –õ–µ–≤—ã–µ –∫–æ–ª—ë—Å–∞ (B, C) -->
              <!-- –ö–æ–ª–µ—Å–æ B (–ø–µ—Ä–µ–¥–Ω–µ–µ –ª–µ–≤–æ–µ) -->
              <g id="wheel-b" transform="translate(70, 170)">
                <!-- –ö–æ–ª–µ—Å–æ -->
                <ellipse cx="0" cy="0" rx="18" ry="22" fill="rgba(255, 107, 107, 0.2)" stroke="#ff6b6b" stroke-width="2"
                  class="wheel" />
                <!-- –°—Ç—Ä–µ–ª–∫–∞ –ø–æ–≤–æ—Ä–æ—Ç–∞ —Å–µ—Ä–≤–æ (—É–≥–æ–ª) -->
                <!-- –ü–æ–≤—ë—Ä–Ω—É—Ç–∞ –Ω–∞ -90¬∞ —á—Ç–æ–±—ã 90¬∞ = —Å—Ç—Ä–µ–ª–∫–∞ –≤–≤–µ—Ä—Ö (–≤–ø–µ—Ä—ë–¥) -->
                <g class="servo-arrow" transform="rotate(-90)">
                  <line x1="0" y1="0" x2="18" y2="0" stroke="#ffcc00" stroke-width="3" stroke-linecap="round" />
                  <polygon points="18,-4 22,0 18,4" fill="#ffcc00" />
                  <text x="-14" y="4" fill="#ffcc00" font-size="8" font-weight="bold"
                    class="servo-angle-text">90¬∞</text>
                </g>
                <!-- –¢–æ–ª—Å—Ç–∞—è —Å—Ç—Ä–µ–ª–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ (—Å–ª–µ–≤–∞ –æ—Ç –∫–æ–ª–µ—Å–∞) -->
                <g class="speed-arrow" transform="translate(-35, 0)">
                  <line x1="0" y1="0" x2="0" y2="0" stroke="#ff6b6b" stroke-width="6" stroke-linecap="round"
                    class="speed-arrow-line" />
                  <text x="0" y="-4" text-anchor="middle" fill="#ff6b6b" font-size="9" font-weight="bold"
                    class="speed-text">0</text>
                </g>
                <!-- –ú–µ—Ç–∫–∞ -->
                <text x="-50" y="4" fill="#ff6b6b" font-size="11" font-weight="bold">B</text>
              </g>

              <!-- –ö–æ–ª–µ—Å–æ C (–∑–∞–¥–Ω–µ–µ –ª–µ–≤–æ–µ) -->
              <g id="wheel-c" transform="translate(70, 225)">
                <ellipse cx="0" cy="0" rx="18" ry="22" fill="rgba(255, 107, 107, 0.2)" stroke="#ff6b6b" stroke-width="2"
                  class="wheel" />
                <g class="servo-arrow" transform="rotate(-90)">
                  <line x1="0" y1="0" x2="18" y2="0" stroke="#ffcc00" stroke-width="3" stroke-linecap="round" />
                  <polygon points="18,-4 22,0 18,4" fill="#ffcc00" />
                  <text x="-14" y="4" fill="#ffcc00" font-size="8" font-weight="bold"
                    class="servo-angle-text">90¬∞</text>
                </g>
                <g class="speed-arrow" transform="translate(-35, 0)">
                  <line x1="0" y1="0" x2="0" y2="0" stroke="#ff6b6b" stroke-width="6" stroke-linecap="round"
                    class="speed-arrow-line" />
                  <text x="0" y="-4" text-anchor="middle" fill="#ff6b6b" font-size="9" font-weight="bold"
                    class="speed-text">0</text>
                </g>
                <text x="-50" y="4" fill="#ff6b6b" font-size="11" font-weight="bold">C</text>
              </g>

              <!-- –ü—Ä–∞–≤—ã–µ –∫–æ–ª—ë—Å–∞ (A, D) -->
              <!-- –ö–æ–ª–µ—Å–æ A (–ø–µ—Ä–µ–¥–Ω–µ–µ –ø—Ä–∞–≤–æ–µ) -->
              <g id="wheel-a" transform="translate(190, 170)">
                <ellipse cx="0" cy="0" rx="18" ry="22" fill="rgba(0, 255, 136, 0.2)" stroke="#00ff88" stroke-width="2"
                  class="wheel" />
                <g class="servo-arrow" transform="rotate(-90)">
                  <line x1="0" y1="0" x2="-18" y2="0" stroke="#ffcc00" stroke-width="3" stroke-linecap="round" />
                  <polygon points="-18,-4 -22,0 -18,4" fill="#ffcc00" />
                  <text x="14" y="4" fill="#ffcc00" font-size="8" font-weight="bold" class="servo-angle-text">90¬∞</text>
                </g>
                <g class="speed-arrow" transform="translate(35, 0)">
                  <line x1="0" y1="0" x2="0" y2="0" stroke="#00ff88" stroke-width="6" stroke-linecap="round"
                    class="speed-arrow-line" />
                  <text x="0" y="-4" text-anchor="middle" fill="#00ff88" font-size="9" font-weight="bold"
                    class="speed-text">0</text>
                </g>
                <text x="55" y="4" fill="#00ff88" font-size="11" font-weight="bold">A</text>
              </g>

              <!-- –ö–æ–ª–µ—Å–æ D (–∑–∞–¥–Ω–µ–µ –ø—Ä–∞–≤–æ–µ) -->
              <g id="wheel-d" transform="translate(190, 225)">
                <ellipse cx="0" cy="0" rx="18" ry="22" fill="rgba(0, 255, 136, 0.2)" stroke="#00ff88" stroke-width="2"
                  class="wheel" />
                <g class="servo-arrow" transform="rotate(-90)">
                  <line x1="0" y1="0" x2="-18" y2="0" stroke="#ffcc00" stroke-width="3" stroke-linecap="round" />
                  <polygon points="-18,-4 -22,0 -18,4" fill="#ffcc00" />
                  <text x="14" y="4" fill="#ffcc00" font-size="8" font-weight="bold" class="servo-angle-text">90¬∞</text>
                </g>
                <g class="speed-arrow" transform="translate(35, 0)">
                  <line x1="0" y1="0" x2="0" y2="0" stroke="#00ff88" stroke-width="6" stroke-linecap="round"
                    class="speed-arrow-line" />
                  <text x="0" y="-4" text-anchor="middle" fill="#00ff88" font-size="9" font-weight="bold"
                    class="speed-text">0</text>
                </g>
                <text x="55" y="4" fill="#00ff88" font-size="11" font-weight="bold">D</text>
              </g>
            </svg>
          </div>

          <div class="motor-status-grid">
            <div class="motor-status-item">
              <h4>Motor A</h4>
              <div class="motor-status-value" id="joy-motorA">0</div>
            </div>
            <div class="motor-status-item">
              <h4>Motor B</h4>
              <div class="motor-status-value" id="joy-motorB">0</div>
            </div>
            <div class="motor-status-item">
              <h4>Motor C</h4>
              <div class="motor-status-value" id="joy-motorC">0</div>
            </div>
            <div class="motor-status-item">
              <h4>Motor D</h4>
              <div class="motor-status-value" id="joy-motorD">0</div>
            </div>
          </div>

          <div style="margin-top: 30px; text-align: center;">
            <button class="btn-stop-all" onclick="stopAllMotorsFromJoystick()"
              style="padding: 15px 40px; font-size: 18px;">üõë –°–¢–û–ü</button>
          </div>

          <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px;">
            <h4 style="color: #00d9ff; margin-bottom: 10px;">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∏:</h4>
            <ul style="color: #aaa; font-size: 14px; line-height: 1.8; padding-left: 20px;">
              <li>–ü–µ—Ä–µ–º–µ—â–∞–π—Ç–µ –¥–∂–æ–π—Å—Ç–∏–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</li>
              <li>–†–µ–∂–∏–º "–ï–∑–¥–∞" - —Ç–∞–Ω–∫–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ—Ç–æ—Ä–∞–º–∏</li>
              <li>–†–µ–∂–∏–º "–°–µ—Ä–≤–æ" - –ø–æ–≤–æ—Ä–æ—Ç –≤—Å–µ—Ö –∫–æ–ª—ë—Å (X –æ—Å—å)</li>
              <li>–†–µ–∂–∏–º "–ú–∏–∫—Å" - –ø–æ–≤–æ—Ä–æ—Ç (X) + —Å–∫–æ—Ä–æ—Å—Ç—å (Y)</li>
              <li>–ö–Ω–æ–ø–∫–∞ "–°–¢–û–ü" –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ –º–æ—Ç–æ—Ä—ã</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ 3: –ö–∞–º–µ—Ä–∞ -->
    <div id="tab-camera" class="tab-content">
      <div class="joystick-container">
        <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å: –í–∏–¥–µ–æ –ø–æ—Ç–æ–∫ -->
        <div class="joystick-panel">
          <h2>üì∑ –í–∏–¥–µ–æ –ø–æ—Ç–æ–∫</h2>

          <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ IP –∞–¥—Ä–µ—Å–∞ –∫–∞–º–µ—Ä—ã -->
          <div style="margin-bottom: 15px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px;">
            <label style="display: block; margin-bottom: 8px; color: #aaa; font-size: 14px;">IP –∞–¥—Ä–µ—Å –∫–∞–º–µ—Ä—ã:</label>
            <div style="display: flex; gap: 10px;">
              <input type="text" id="camera-ip" value="192.168.1.111:81"
                style="flex: 1; padding: 8px; border: 1px solid rgba(255,255,255,0.2); border-radius: 5px; background: rgba(255,255,255,0.1); color: white;">
              <button onclick="updateCameraUrl()"
                style="padding: 8px 16px; background: #00d9ff; color: #1a1a2e; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">–û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>
          </div>

          <div
            style="position: relative; width: 100%; padding-top: 75%; background: #000; border-radius: 10px; overflow: hidden;">
            <img id="camera-stream" src="http://192.168.1.111:81/" alt="Camera Stream"
              style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: contain;"
              onerror="this.style.display='none'; document.getElementById('camera-error').style.display='block';"
              onload="this.style.display='block'; document.getElementById('camera-error').style.display='none';">
            <div id="camera-error"
              style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: #ff6b6b;">
              <div style="font-size: 48px; margin-bottom: 10px;">üì∑</div>
              <div>–ö–∞–º–µ—Ä–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞</div>
              <div style="font-size: 12px; color: #aaa; margin-top: 5px;">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</div>
              <div style="font-size: 11px; color: #888; margin-top: 10px;">URL: <span id="camera-url-display">http://192.168.1.111:81/</span></div>
            </div>
          </div>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å: –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –®–ò–ú —Å–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥–æ–≤ –∫–∞–º–µ—Ä—ã -->
        <div class="joystick-panel">
          <h2>üéÆ –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –®–ò–ú</h2>

          <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –®–ò–ú -->
          <div class="info-box">
            <h4>üìñ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–Ω–∞—á–µ–Ω–∏—è—Ö –®–ò–ú (360¬∞)</h4>
            <ul>
              <li><strong>–¢–∏–ø —Å–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥–∞:</strong> 360¬∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –≤—Ä–∞—â–µ–Ω–∏—è</li>
              <li><strong>–î–∏–∞–ø–∞–∑–æ–Ω –®–ò–ú:</strong> 200 - 400 (12-bit PCA9685)</li>
              <li><strong>–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ (—Å—Ç–æ–ø):</strong> 300</li>
              <li><strong>–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:</strong> 200 (–≤—Ä–∞—â–µ–Ω–∏–µ –≤–ª–µ–≤–æ/–≤–Ω–∏–∑)</li>
              <li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:</strong> 400 (–≤—Ä–∞—â–µ–Ω–∏–µ –≤–ø—Ä–∞–≤–æ/–≤–≤–µ—Ä—Ö)</li>
              <li><strong>–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:</strong> –ò–º–ø—É–ª—å—Å + –≤—Ä–µ–º—è (–ø–æ–¥–∞—á–∞ –∏–º–ø—É–ª—å—Å–∞ –Ω–∞ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è, –∑–∞—Ç–µ–º –æ—Å—Ç–∞–Ω–æ–≤–∫–∞)</li>
              <li><strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> 360¬∞ —Å–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥—ã –≤—Ä–∞—â–∞—é—Ç—Å—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞</li>
            </ul>
          </div>

          <!-- Pan Servo (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ) -->
          <div style="margin-bottom: 25px;">
            <h3 style="color: #ffcc00; margin-bottom: 15px; font-size: 16px;">üîÑ Pan (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ)</h3>

            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 8px; color: #aaa; font-size: 14px;">
                –®–ò–ú –∑–Ω–∞—á–µ–Ω–∏–µ: <span id="pan-pwm-value" style="color: #00d9ff; font-weight: bold;">300</span>
              </label>
              <input type="range" id="pan-pwm-slider" min="200" max="400" value="300" oninput="updatePanPwmDisplay(this.value)"
                style="width: 100%;">
              <div style="font-size: 11px; color: #666; margin-top: 5px;">
                200 ‚Üê –≤–ª–µ–≤–æ | 300 = —Ü–µ–Ω—Ç—Ä (—Å—Ç–æ–ø) | 400 –≤–ø—Ä–∞–≤–æ ‚Üí
              </div>
            </div>

            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 8px; color: #aaa; font-size: 14px;">
                –í—Ä–µ–º—è –∏–º–ø—É–ª—å—Å–∞ (–º—Å): <span id="pan-duration-value" style="color: #00d9ff; font-weight: bold;">100</span>
              </label>
              <input type="range" id="pan-duration-slider" min="10" max="1000" value="100" oninput="updatePanDurationDisplay(this.value)"
                style="width: 100%;">
              <div style="font-size: 11px; color: #666; margin-top: 5px;">
                10 ‚Üê –∫–æ—Ä–æ—Ç–∫–∏–π | 100 —Å—Ä–µ–¥–Ω–∏–π | 1000 –¥–ª–∏–Ω–Ω—ã–π ‚Üí
              </div>
            </div>

            <div style="display: flex; gap: 10px;">
              <input type="number" id="pan-pwm-input" min="200" max="400" value="300" placeholder="200-400"
                style="flex: 1; padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 5px; background: rgba(255,255,255,0.1); color: white; font-size: 16px;">
              <input type="number" id="pan-duration-input" min="10" max="1000" value="100" placeholder="10-1000"
                style="flex: 1; padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 5px; background: rgba(255,255,255,0.1); color: white; font-size: 16px;">
              <button onclick="setCameraPulse()"
                style="padding: 10px 20px; background: #00d9ff; color: #1a1a2e; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">–ü—É–ª—å—Å</button>
            </div>
          </div>

          <!-- Tilt Servo (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ) -->
          <div style="margin-bottom: 25px;">
            <h3 style="color: #ffcc00; margin-bottom: 15px; font-size: 16px;">‚ÜïÔ∏è Tilt (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ)</h3>

            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 8px; color: #aaa; font-size: 14px;">
                –®–ò–ú –∑–Ω–∞—á–µ–Ω–∏–µ: <span id="tilt-pwm-value" style="color: #00d9ff; font-weight: bold;">300</span>
              </label>
              <input type="range" id="tilt-pwm-slider" min="200" max="400" value="300" oninput="updateTiltPwmDisplay(this.value)"
                style="width: 100%;">
              <div style="font-size: 11px; color: #666; margin-top: 5px;">
                200 ‚Üê –≤–Ω–∏–∑ | 300 = —Ü–µ–Ω—Ç—Ä (—Å—Ç–æ–ø) | 400 –≤–≤–µ—Ä—Ö ‚Üí
              </div>
            </div>

            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 8px; color: #aaa; font-size: 14px;">
                –í—Ä–µ–º—è –∏–º–ø—É–ª—å—Å–∞ (–º—Å): <span id="tilt-duration-value" style="color: #00d9ff; font-weight: bold;">100</span>
              </label>
              <input type="range" id="tilt-duration-slider" min="10" max="1000" value="100" oninput="updateTiltDurationDisplay(this.value)"
                style="width: 100%;">
              <div style="font-size: 11px; color: #666; margin-top: 5px;">
                10 ‚Üê –∫–æ—Ä–æ—Ç–∫–∏–π | 100 —Å—Ä–µ–¥–Ω–∏–π | 1000 –¥–ª–∏–Ω–Ω—ã–π ‚Üí
              </div>
            </div>

            <div style="display: flex; gap: 10px;">
              <input type="number" id="tilt-pwm-input" min="200" max="400" value="300" placeholder="200-400"
                style="flex: 1; padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 5px; background: rgba(255,255,255,0.1); color: white; font-size: 16px;">
              <input type="number" id="tilt-duration-input" min="10" max="1000" value="100" placeholder="10-1000"
                style="flex: 1; padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 5px; background: rgba(255,255,255,0.1); color: white; font-size: 16px;">
              <button onclick="setCameraPulse()"
                style="padding: 10px 20px; background: #00d9ff; color: #1a1a2e; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">–ü—É–ª—å—Å</button>
            </div>
          </div>

          <!-- –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–µ—Å–µ—Ç—ã -->
          <div style="padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
            <h3 style="color: #ffcc00; margin-bottom: 15px; font-size: 16px;">‚ö° –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–µ—Å–µ—Ç—ã (–∏–º–ø—É–ª—å—Å 100–º—Å)</h3>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
              <button onclick="setCameraPulsePreset(300, 300, 100)"
                style="padding: 12px; background: rgba(0, 255, 136, 0.2); border: 1px solid #00ff88; border-radius: 8px; color: #00ff88; cursor: pointer; font-weight: bold;">
                üéØ –¶–µ–Ω—Ç—Ä (300, 300)
              </button>
              <button onclick="setCameraPulsePreset(250, 300, 100)"
                style="padding: 12px; background: rgba(0, 217, 255, 0.2); border: 1px solid #00d9ff; border-radius: 8px; color: #00d9ff; cursor: pointer; font-weight: bold;">
                ‚óÄ –í–ª–µ–≤–æ (250, 300)
              </button>
              <button onclick="setCameraPulsePreset(350, 300, 100)"
                style="padding: 12px; background: rgba(0, 217, 255, 0.2); border: 1px solid #00d9ff; border-radius: 8px; color: #00d9ff; cursor: pointer; font-weight: bold;">
                –í–ø—Ä–∞–≤–æ ‚ñ∂ (350, 300)
              </button>
              <button onclick="setCameraPulsePreset(300, 250, 100)"
                style="padding: 12px; background: rgba(0, 217, 255, 0.2); border: 1px solid #00d9ff; border-radius: 8px; color: #00d9ff; cursor: pointer; font-weight: bold;">
                ‚ñº –í–Ω–∏–∑ (300, 250)
              </button>
              <button onclick="setCameraPulsePreset(300, 350, 100)"
                style="padding: 12px; background: rgba(0, 217, 255, 0.2); border: 1px solid #00d9ff; border-radius: 8px; color: #00d9ff; cursor: pointer; font-weight: bold;">
                ‚ñ≤ –í–≤–µ—Ä—Ö (300, 350)
              </button>
              <button onclick="setCameraPulsePreset(250, 250, 100)"
                style="padding: 12px; background: rgba(255, 204, 0, 0.2); border: 1px solid #ffcc00; border-radius: 8px; color: #ffcc00; cursor: pointer; font-weight: bold;">
                ‚¨ÖÔ∏è‚ÜòÔ∏è –õ–µ–≤–æ-–í–Ω–∏–∑ (250, 250)
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫–∏ JavaScript -->
  <script>
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º
    function loadScript(src, callback) {
      const script = document.createElement('script');
      script.src = src;
      script.async = false;
      script.onload = callback;
      script.onerror = () => {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', src);
        document.getElementById('js-loader').textContent = '‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ' + src;
        document.getElementById('js-loader').style.background = '#ff4444';
      };
      document.body.appendChild(script);
    }

    // –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤
    loadScript('joystick.js', function() {
      loadScript('main.js', function() {
        // –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã
        document.getElementById('js-loader').textContent = '‚úÖ JavaScript –∑–∞–≥—Ä—É–∂–µ–Ω';
        document.getElementById('js-loader').style.background = '#00ff88';
        document.body.classList.remove('loading');
        
        // –£–±–∏—Ä–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
          document.getElementById('js-loader').style.display = 'none';
        }, 2000);
      });
    });
  </script>
</body>

</html>
